{"format_version":"1.2","terraform_version":"1.12.1","variables":{"allocated_storage":{"value":20},"ami_id":{"value":"ami-0c55b159cbfafe1f0"},"availability_zone_a":{"value":"us-east-1a"},"availability_zone_b":{"value":"us-east-1b"},"cloudfront_domain_aliases":{"value":["example.cmmcsecure.com"]},"cost_center":{"value":"CyberSec001"},"created_by":{"value":"coldchainsecure"},"data_bucket_name":{"value":"data_bucket"},"db_password":{"value":"YourSecurePasswordHere!"},"db_username":{"value":"dbadmin"},"ebs_device_name":{"value":"/dev/sda1"},"engine":{"value":"postgres"},"engine_version":{"value":"13.4"},"environment":{"value":"production"},"flow_log_group_name":{"value":"vpc-flow-logs"},"flow_log_role_name":{"value":"flow-role"},"instance_class":{"value":"db.t3.small"},"instance_type":{"value":"t3.micro"},"log_bucket_name":{"value":"log_bucket"},"name_prefix":{"value":"cmmc"},"owner":{"value":"Coldchain Secure"},"project":{"value":"CMMC Infra"},"region":{"value":"us-east-1"},"retention_in_days":{"value":90},"route_cidr_block":{"value":"0.0.0.0/0"},"s3_acl":{"value":"private"},"security_group_egress_rules":{"value":[{"cidr_blocks":["0.0.0.0/0"],"description":"Allow all outbound","from_port":0,"ipv6_cidr_blocks":["::/0"],"protocol":"-1","to_port":0},{"description":"Allow internal SG egress","from_port":443,"protocol":"tcp","to_port":443}]},"security_group_ingress_rules":{"value":[{"cidr_blocks":["203.0.113.0/24"],"description":"Allow HTTPS","from_port":443,"ipv6_cidr_blocks":["::/0"],"protocol":"tcp","to_port":443},{"cidr_blocks":["10.0.10.0/24"],"description":"Allow SSH from Admin VPN","from_port":22,"protocol":"tcp","to_port":22},{"description":"Internal SG Communication","from_port":8080,"protocol":"tcp","to_port":8080}]},"skip_final_snapshot":{"value":true},"sse_algorithm":{"value":"aws:kms"},"storage_encrypted":{"value":true},"subnet_cidr_a":{"value":"10.0.1.0/24"},"subnet_cidr_b":{"value":"10.0.2.0/24"},"trusted_ip_range":{"value":"203.0.113.0/24"},"use_existing_route53":{"value":false},"vpc_cidr":{"value":"10.0.0.0/16"},"vpc_name":{"value":"cmmc-vpc"}},"planned_values":{"outputs":{"acm_certificate_arn":{"sensitive":false},"aws_config_delivery_channel":{"sensitive":false,"type":"string","value":"cmmc-delivery-channel"},"aws_config_recorder_name":{"sensitive":false,"type":"string","value":"cmmc-recorder"},"cloudfront_distribution_domain":{"sensitive":false},"cloudfront_distribution_id":{"sensitive":false},"data_bucket_name":{"sensitive":false,"type":"string","value":"data_bucket"},"ec2_instance_id":{"sensitive":false},"ec2_public_ip":{"sensitive":false},"flow_log_group_name":{"sensitive":false},"flow_log_role_name":{"sensitive":false,"type":"string","value":"cmmc-flow-role"},"kms_key_arn":{"sensitive":false},"kms_key_id":{"sensitive":false},"log_bucket_name":{"sensitive":false,"type":"string","value":"log_bucket"},"rds_endpoint":{"sensitive":false},"rds_instance_id":{"sensitive":false},"route53_zone_id":{"sensitive":false},"security_group_id":{"sensitive":false},"subnet_a_id":{"sensitive":false},"subnet_b_id":{"sensitive":false},"subnet_ids":{"sensitive":false},"vpc_id":{"sensitive":false},"waf_acl_arn":{"sensitive":false}},"root_module":{"child_modules":[{"resources":[{"address":"module.acm.aws_acm_certificate.cloudfront_cert","mode":"managed","type":"aws_acm_certificate","name":"cloudfront_cert","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"example.cmmcsecure.com","domain_validation_options":[{"domain_name":"example.cmmcsecure.com"}],"early_renewal_duration":null,"private_key":null,"subject_alternative_names":["example.cmmcsecure.com"],"validation_method":"DNS","validation_option":[]},"sensitive_values":{"domain_validation_options":[{}],"options":[],"private_key":true,"renewal_summary":[],"subject_alternative_names":[false],"tags":{},"tags_all":{},"validation_emails":[],"validation_option":[]}},{"address":"module.acm.aws_acm_certificate_validation.cert","mode":"managed","type":"aws_acm_certificate_validation","name":"cert","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"timeouts":null},"sensitive_values":{"validation_record_fqdns":[]}},{"address":"module.acm.aws_route53_record.cert_validation[\"example.cmmcsecure.com\"]","mode":"managed","type":"aws_route53_record","name":"cert_validation","index":"example.cmmcsecure.com","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[],"cidr_routing_policy":[],"failover_routing_policy":[],"geolocation_routing_policy":[],"geoproximity_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"set_identifier":null,"timeouts":null,"ttl":60,"weighted_routing_policy":[]},"sensitive_values":{"alias":[],"cidr_routing_policy":[],"failover_routing_policy":[],"geolocation_routing_policy":[],"geoproximity_routing_policy":[],"latency_routing_policy":[],"records":[],"weighted_routing_policy":[]}}],"address":"module.acm"},{"resources":[{"address":"module.cloudfront.aws_cloudfront_distribution.secure_distribution","mode":"managed","type":"aws_cloudfront_distribution","name":"secure_distribution","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"aliases":["example.cmmcsecure.com"],"comment":"CMMC-secure CloudFront distribution","custom_error_response":[],"default_cache_behavior":[{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":false,"default_ttl":3600,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"none"}],"query_string":false}],"function_association":[],"lambda_function_association":[],"max_ttl":86400,"min_ttl":0,"origin_request_policy_id":null,"realtime_log_config_arn":null,"response_headers_policy_id":null,"smooth_streaming":null,"target_origin_id":"s3-origin","viewer_protocol_policy":"redirect-to-https"}],"default_root_object":"index.html","enabled":true,"http_version":"http2","is_ipv6_enabled":true,"logging_config":[],"ordered_cache_behavior":[],"origin":[{"connection_attempts":3,"connection_timeout":10,"custom_header":[],"custom_origin_config":[],"domain_name":"data_bucket.s3.us-east-1.amazonaws.com","origin_access_control_id":"","origin_id":"s3-origin","origin_path":"","origin_shield":[],"s3_origin_config":[{}],"vpc_origin_config":[]}],"origin_group":[],"price_class":"PriceClass_All","restrictions":[{"geo_restriction":[{"restriction_type":"none"}]}],"retain_on_delete":false,"staging":false,"viewer_certificate":[{"cloudfront_default_certificate":null,"iam_certificate_id":null,"minimum_protocol_version":"TLSv1.2_2021","ssl_support_method":"sni-only"}],"wait_for_deployment":true},"sensitive_values":{"aliases":[false],"custom_error_response":[],"default_cache_behavior":[{"allowed_methods":[false,false],"cached_methods":[false,false],"forwarded_values":[{"cookies":[{"whitelisted_names":[]}],"headers":[],"query_string_cache_keys":[]}],"function_association":[],"grpc_config":[],"lambda_function_association":[],"trusted_key_groups":[],"trusted_signers":[]}],"logging_config":[],"ordered_cache_behavior":[],"origin":[{"custom_header":[],"custom_origin_config":[],"origin_shield":[],"s3_origin_config":[{}],"vpc_origin_config":[]}],"origin_group":[],"restrictions":[{"geo_restriction":[{"locations":[]}]}],"tags":{},"tags_all":{},"trusted_key_groups":[],"trusted_signers":[],"viewer_certificate":[{}]}},{"address":"module.cloudfront.aws_cloudfront_origin_access_identity.oai","mode":"managed","type":"aws_cloudfront_origin_access_identity","name":"oai","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"comment":"OAI for cmmc-cloudfront"},"sensitive_values":{}}],"address":"module.cloudfront"},{"resources":[{"address":"module.cloudtrail.aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"advanced_event_selector":[],"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":true,"enable_logging":true,"event_selector":[{"data_resource":[{"type":"AWS::S3::Object","values":["arn:aws:s3:::"]}],"exclude_management_event_sources":null,"include_management_events":true,"read_write_type":"All"}],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":true,"is_organization_trail":false,"name":"cmmc-trail","s3_bucket_name":"log_bucket","s3_key_prefix":null,"sns_topic_name":null},"sensitive_values":{"advanced_event_selector":[],"event_selector":[{"data_resource":[{"values":[false]}]}],"insight_selector":[],"tags":{},"tags_all":{}}}],"address":"module.cloudtrail"},{"resources":[{"address":"module.compute.aws_iam_instance_profile.ec2_instance_profile","mode":"managed","type":"aws_iam_instance_profile","name":"ec2_instance_profile","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"cmmc-instance-profile","path":"/","role":"cmmc-ec2-role","tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"}},"sensitive_values":{"tags_all":{}}},{"address":"module.compute.aws_iam_role.ec2_role","mode":"managed","type":"aws_iam_role","name":"ec2_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cmmc-ec2-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}},{"address":"module.compute.aws_iam_role_policy.ec2_policy","mode":"managed","type":"aws_iam_role_policy","name":"ec2_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"cmmc-ec2-policy"},"sensitive_values":{}},{"address":"module.compute.aws_instance.cmmc_ec2","mode":"managed","type":"aws_instance","name":"cmmc_ec2","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"ami":"ami-0c55b159cbfafe1f0","credit_specification":[],"disable_api_termination":true,"ebs_block_device":[{"delete_on_termination":true,"device_name":"/dev/sda1","encrypted":true,"tags":null}],"get_password_data":false,"hibernation":null,"iam_instance_profile":"cmmc-instance-profile","instance_type":"t3.micro","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_protocol_ipv6":"disabled","http_put_response_hop_limit":1,"http_tokens":"required"}],"monitoring":true,"source_dest_check":true,"timeouts":null,"user_data_base64":"IyEvYmluL2Jhc2gKeXVtIHVwZGF0ZSAteQphbWF6b24tbGludXgtZXh0cmFzIGVuYWJsZSBlcGVsCnl1bSBpbnN0YWxsIC15IGVwZWwtcmVsZWFzZQoKIyBJbnN0YWxsIEFwYWNoZQp5dW0gaW5zdGFsbCAteSBodHRwZApzeXN0ZW1jdGwgZW5hYmxlIGh0dHBkCnN5c3RlbWN0bCBzdGFydCBodHRwZAoKIyBJbnN0YWxsIENsb3VkV2F0Y2ggQWdlbnQKeXVtIGluc3RhbGwgLXkgYW1hem9uLWNsb3Vkd2F0Y2gtYWdlbnQKL29wdC9hd3MvYW1hem9uLWNsb3Vkd2F0Y2gtYWdlbnQvYmluL2FtYXpvbi1jbG91ZHdhdGNoLWFnZW50LWN0bCBcCiAgLWEgZmV0Y2gtY29uZmlnIC1tIGVjMiBcCiAgLWMgc3NtOkFtYXpvbkNsb3VkV2F0Y2gtbGludXgtY29uZmlnIFwKICAtcwoKIyBJbnN0YWxsIGFuZCBjb25maWd1cmUgU1NNIEFnZW50Cnl1bSBpbnN0YWxsIC15IGh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9lYzItZG93bmxvYWRzLXdpbmRvd3MvU1NNQWdlbnQvbGF0ZXN0L2xpbnV4X2FtZDY0L2FtYXpvbi1zc20tYWdlbnQucnBtCnN5c3RlbWN0bCBlbmFibGUgYW1hem9uLXNzbS1hZ2VudApzeXN0ZW1jdGwgc3RhcnQgYW1hem9uLXNzbS1hZ2VudAo=","user_data_replace_on_change":false,"volume_tags":null},"sensitive_values":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[{"tags_all":{}}],"enclave_options":[],"ephemeral_block_device":[],"instance_market_options":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"private_dns_name_options":[],"root_block_device":[],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}}],"address":"module.compute"},{"resources":[{"address":"module.config.aws_config_configuration_recorder.recorder","mode":"managed","type":"aws_config_configuration_recorder","name":"recorder","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"cmmc-recorder","recording_group":[{"all_supported":true,"include_global_resource_types":true,"resource_types":null}]},"sensitive_values":{"recording_group":[{"exclusion_by_resource_types":[],"recording_strategy":[]}],"recording_mode":[]}},{"address":"module.config.aws_config_delivery_channel.delivery","mode":"managed","type":"aws_config_delivery_channel","name":"delivery","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"cmmc-delivery-channel","s3_bucket_name":"log_bucket","s3_key_prefix":null,"s3_kms_key_arn":null,"snapshot_delivery_properties":[{"delivery_frequency":"Six_Hours"}],"sns_topic_arn":null},"sensitive_values":{"snapshot_delivery_properties":[{}]}},{"address":"module.config.aws_iam_role.config_role","mode":"managed","type":"aws_iam_role","name":"config_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"config.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cmmc-config-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"}},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}},{"address":"module.config.aws_iam_role_policy.config_policy","mode":"managed","type":"aws_iam_role_policy","name":"config_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"cmmc-config-policy"},"sensitive_values":{}}],"address":"module.config"},{"resources":[{"address":"module.kms.aws_kms_key.cmmc_kms","mode":"managed","type":"aws_kms_key","name":"cmmc_kms","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":30,"description":"CMMC-compliant KMS key for data encryption","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\"Statement\":[{\"Action\":[\"kms:Create*\",\"kms:Describe*\",\"kms:Enable*\",\"kms:List*\",\"kms:Put*\",\"kms:Update*\",\"kms:Revoke*\",\"kms:Disable*\",\"kms:Get*\",\"kms:Delete*\",\"kms:ScheduleKeyDeletion\",\"kms:CancelKeyDeletion\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::905418409326:root\"},\"Resource\":\"*\",\"Sid\":\"AllowAdminKeyManagement\"},{\"Action\":[\"kms:GenerateDataKey*\",\"kms:Encrypt\",\"kms:Decrypt\",\"kms:ReEncrypt*\",\"kms:DescribeKey\"],\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"*\",\"Sid\":\"AllowCloudTrailKMSUsage\"}],\"Version\":\"2012-10-17\"}","timeouts":null,"xks_key_id":null},"sensitive_values":{"tags":{},"tags_all":{}}}],"address":"module.kms"},{"resources":[{"address":"module.logging.aws_cloudwatch_log_group.cmmc_vpc_flow","mode":"managed","type":"aws_cloudwatch_log_group","name":"cmmc_vpc_flow","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":null,"name":"vpc-flow-logs","retention_in_days":90,"skip_destroy":false},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.logging.aws_flow_log.vpc_flow_log","mode":"managed","type":"aws_flow_log","name":"vpc_flow_log","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deliver_cross_account_role":null,"destination_options":[],"eni_id":null,"log_destination_type":"cloud-watch-logs","log_format":"${timestamp} ${interface-id} ${srcaddr} ${dstaddr} ${protocol} ${packets} ${bytes} ${action} ${log-status}","max_aggregation_interval":600,"subnet_id":null,"tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"},"traffic_type":"ALL","transit_gateway_attachment_id":null,"transit_gateway_id":null},"sensitive_values":{"destination_options":[],"tags_all":{}}},{"address":"module.logging.aws_iam_role.cmmc_flow_role","mode":"managed","type":"aws_iam_role","name":"cmmc_flow_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"vpc-flow-logs.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cmmc-flow-role","path":"/","permissions_boundary":null},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}},{"address":"module.logging.aws_iam_role_policy.cmmc_flow_policy","mode":"managed","type":"aws_iam_role_policy","name":"cmmc_flow_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"cmmc_flow_log_policy"},"sensitive_values":{}}],"address":"module.logging"},{"resources":[{"address":"module.networking.aws_internet_gateway.igw","mode":"managed","type":"aws_internet_gateway","name":"igw","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.networking.aws_route_table.rt","mode":"managed","type":"aws_route_table","name":"rt","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"route":[{"carrier_gateway_id":"","cidr_block":"0.0.0.0/0","core_network_arn":"","destination_prefix_list_id":"","egress_only_gateway_id":"","ipv6_cidr_block":"","local_gateway_id":"","nat_gateway_id":"","network_interface_id":"","transit_gateway_id":"","vpc_endpoint_id":"","vpc_peering_connection_id":""}],"timeouts":null},"sensitive_values":{"propagating_vgws":[],"route":[{}],"tags":{},"tags_all":{}}},{"address":"module.networking.aws_route_table_association.rta_a","mode":"managed","type":"aws_route_table_association","name":"rta_a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"timeouts":null},"sensitive_values":{}},{"address":"module.networking.aws_route_table_association.rta_b","mode":"managed","type":"aws_route_table_association","name":"rta_b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"timeouts":null},"sensitive_values":{}},{"address":"module.networking.aws_security_group.main_sg","mode":"managed","type":"aws_security_group","name":"main_sg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Main security group","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"Allow all outbound","from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0},{"cidr_blocks":[],"description":"Allow internal SG egress","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"ingress":[{"cidr_blocks":["10.0.10.0/24"],"description":"Allow SSH from Admin VPN","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22},{"cidr_blocks":["203.0.113.0/24"],"description":"Allow HTTPS","from_port":443,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443},{"cidr_blocks":[],"description":"Internal SG Communication","from_port":8080,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":8080}],"name":"cmmc-vpc-sg","revoke_rules_on_delete":false,"timeouts":null},"sensitive_values":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags":{},"tags_all":{}}},{"address":"module.networking.aws_subnet.subnet_a","mode":"managed","type":"aws_subnet","name":"subnet_a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.networking.aws_subnet.subnet_b","mode":"managed","type":"aws_subnet","name":"subnet_b","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.0.2.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"timeouts":null},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"module.networking.aws_vpc.main","mode":"managed","type":"aws_vpc","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null},"sensitive_values":{"tags":{},"tags_all":{}}}],"address":"module.networking"},{"resources":[{"address":"module.rds.aws_db_instance.postgres","mode":"managed","type":"aws_db_instance","name":"postgres","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"db_subnet_group_name":"cmmc-db-subnet","dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"13.4","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"cmmc-postgres","instance_class":"db.t3.small","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"password":"YourSecurePasswordHere!","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":true,"timeouts":null,"upgrade_storage_config":null,"username":"dbadmin"},"sensitive_values":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"password_wo":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}},{"address":"module.rds.aws_db_subnet_group.db_subnet_group","mode":"managed","type":"aws_db_subnet_group","name":"db_subnet_group","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Managed by Terraform","name":"cmmc-db-subnet"},"sensitive_values":{"subnet_ids":[],"supported_network_types":[],"tags":{},"tags_all":{}}}],"address":"module.rds"},{"resources":[{"address":"module.route53.aws_route53_zone.new_zone[0]","mode":"managed","type":"aws_route53_zone","name":"new_zone","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"comment":"Managed by Terraform","delegation_set_id":null,"force_destroy":false,"name":"example.cmmcsecure.com","tags":{"Name":"example.cmmcsecure.com-zone"},"tags_all":{"Environment":"production","Name":"example.cmmcsecure.com-zone","Owner":"Coldchain Secure","Project":"CMMC Infra"},"timeouts":null,"vpc":[]},"sensitive_values":{"name_servers":[],"tags":{},"tags_all":{},"vpc":[]}}],"address":"module.route53"},{"resources":[{"address":"module.s3.aws_s3_bucket.data","mode":"managed","type":"aws_s3_bucket","name":"data","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"data_bucket","force_destroy":false,"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}},{"address":"module.s3.aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"log_bucket","force_destroy":false,"timeouts":null},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}},{"address":"module.s3.aws_s3_bucket_acl.data_acl","mode":"managed","type":"aws_s3_bucket_acl","name":"data_acl","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","expected_bucket_owner":null},"sensitive_values":{"access_control_policy":[]}},{"address":"module.s3.aws_s3_bucket_acl.logs_acl","mode":"managed","type":"aws_s3_bucket_acl","name":"logs_acl","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","expected_bucket_owner":null},"sensitive_values":{"access_control_policy":[]}},{"address":"module.s3.aws_s3_bucket_policy.data_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"data_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"sensitive_values":{}},{"address":"module.s3.aws_s3_bucket_policy.logs_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"logs_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"sensitive_values":{}},{"address":"module.s3.aws_s3_bucket_public_access_block.data_block","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"data_block","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"sensitive_values":{}},{"address":"module.s3.aws_s3_bucket_public_access_block.logs_block","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs_block","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"sensitive_values":{}},{"address":"module.s3.aws_s3_bucket_server_side_encryption_configuration.data_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"data_encryption","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}},{"address":"module.s3.aws_s3_bucket_server_side_encryption_configuration.logs_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs_encryption","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]},"sensitive_values":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}],"address":"module.s3"},{"resources":[{"address":"module.waf.aws_wafv2_web_acl.cloudfront_acl","mode":"managed","type":"aws_wafv2_web_acl","name":"cloudfront_acl","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"description":"WAF for CloudFront distribution","name":"cloudfront-waf-acl","rule":[{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":1,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesCommonRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]}],"rule_json":null,"scope":"CLOUDFRONT","token_domains":null,"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"cloudfront-waf","sampled_requests_enabled":true}]},"sensitive_values":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"rule":[{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}],"address":"module.waf"}]}},"resource_changes":[{"address":"module.acm.aws_acm_certificate.cloudfront_cert","module_address":"module.acm","mode":"managed","type":"aws_acm_certificate","name":"cloudfront_cert","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"example.cmmcsecure.com","domain_validation_options":[{"domain_name":"example.cmmcsecure.com"}],"early_renewal_duration":null,"private_key":null,"subject_alternative_names":["example.cmmcsecure.com"],"validation_method":"DNS","validation_option":[]},"after_unknown":{"arn":true,"domain_validation_options":[{"resource_record_name":true,"resource_record_type":true,"resource_record_value":true}],"id":true,"key_algorithm":true,"not_after":true,"not_before":true,"options":true,"pending_renewal":true,"renewal_eligibility":true,"renewal_summary":true,"status":true,"subject_alternative_names":[false],"tags":true,"tags_all":true,"type":true,"validation_emails":true,"validation_option":[]},"before_sensitive":false,"after_sensitive":{"domain_validation_options":[{}],"options":[],"private_key":true,"renewal_summary":[],"subject_alternative_names":[false],"tags":{},"tags_all":{},"validation_emails":[],"validation_option":[]}}},{"address":"module.acm.aws_acm_certificate_validation.cert","module_address":"module.acm","mode":"managed","type":"aws_acm_certificate_validation","name":"cert","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"timeouts":null},"after_unknown":{"certificate_arn":true,"id":true,"validation_record_fqdns":true},"before_sensitive":false,"after_sensitive":{"validation_record_fqdns":[]}}},{"address":"module.acm.aws_route53_record.cert_validation[\"example.cmmcsecure.com\"]","module_address":"module.acm","mode":"managed","type":"aws_route53_record","name":"cert_validation","index":"example.cmmcsecure.com","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[],"cidr_routing_policy":[],"failover_routing_policy":[],"geolocation_routing_policy":[],"geoproximity_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"set_identifier":null,"timeouts":null,"ttl":60,"weighted_routing_policy":[]},"after_unknown":{"alias":[],"allow_overwrite":true,"cidr_routing_policy":[],"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"geoproximity_routing_policy":[],"id":true,"latency_routing_policy":[],"name":true,"records":true,"type":true,"weighted_routing_policy":[],"zone_id":true},"before_sensitive":false,"after_sensitive":{"alias":[],"cidr_routing_policy":[],"failover_routing_policy":[],"geolocation_routing_policy":[],"geoproximity_routing_policy":[],"latency_routing_policy":[],"records":[],"weighted_routing_policy":[]}}},{"address":"module.cloudfront.aws_cloudfront_distribution.secure_distribution","module_address":"module.cloudfront","mode":"managed","type":"aws_cloudfront_distribution","name":"secure_distribution","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"aliases":["example.cmmcsecure.com"],"comment":"CMMC-secure CloudFront distribution","custom_error_response":[],"default_cache_behavior":[{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":false,"default_ttl":3600,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"none"}],"query_string":false}],"function_association":[],"lambda_function_association":[],"max_ttl":86400,"min_ttl":0,"origin_request_policy_id":null,"realtime_log_config_arn":null,"response_headers_policy_id":null,"smooth_streaming":null,"target_origin_id":"s3-origin","viewer_protocol_policy":"redirect-to-https"}],"default_root_object":"index.html","enabled":true,"http_version":"http2","is_ipv6_enabled":true,"logging_config":[],"ordered_cache_behavior":[],"origin":[{"connection_attempts":3,"connection_timeout":10,"custom_header":[],"custom_origin_config":[],"domain_name":"data_bucket.s3.us-east-1.amazonaws.com","origin_access_control_id":"","origin_id":"s3-origin","origin_path":"","origin_shield":[],"s3_origin_config":[{}],"vpc_origin_config":[]}],"origin_group":[],"price_class":"PriceClass_All","restrictions":[{"geo_restriction":[{"restriction_type":"none"}]}],"retain_on_delete":false,"staging":false,"viewer_certificate":[{"cloudfront_default_certificate":null,"iam_certificate_id":null,"minimum_protocol_version":"TLSv1.2_2021","ssl_support_method":"sni-only"}],"wait_for_deployment":true},"after_unknown":{"aliases":[false],"arn":true,"caller_reference":true,"continuous_deployment_policy_id":true,"custom_error_response":[],"default_cache_behavior":[{"allowed_methods":[false,false],"cached_methods":[false,false],"forwarded_values":[{"cookies":[{"whitelisted_names":true}],"headers":true,"query_string_cache_keys":true}],"function_association":[],"grpc_config":true,"lambda_function_association":[],"trusted_key_groups":true,"trusted_signers":true}],"domain_name":true,"etag":true,"hosted_zone_id":true,"id":true,"in_progress_validation_batches":true,"last_modified_time":true,"logging_config":[],"ordered_cache_behavior":[],"origin":[{"custom_header":[],"custom_origin_config":[],"origin_shield":[],"s3_origin_config":[{"origin_access_identity":true}],"vpc_origin_config":[]}],"origin_group":[],"restrictions":[{"geo_restriction":[{"locations":true}]}],"status":true,"tags":true,"tags_all":true,"trusted_key_groups":true,"trusted_signers":true,"viewer_certificate":[{"acm_certificate_arn":true}],"web_acl_id":true},"before_sensitive":false,"after_sensitive":{"aliases":[false],"custom_error_response":[],"default_cache_behavior":[{"allowed_methods":[false,false],"cached_methods":[false,false],"forwarded_values":[{"cookies":[{"whitelisted_names":[]}],"headers":[],"query_string_cache_keys":[]}],"function_association":[],"grpc_config":[],"lambda_function_association":[],"trusted_key_groups":[],"trusted_signers":[]}],"logging_config":[],"ordered_cache_behavior":[],"origin":[{"custom_header":[],"custom_origin_config":[],"origin_shield":[],"s3_origin_config":[{}],"vpc_origin_config":[]}],"origin_group":[],"restrictions":[{"geo_restriction":[{"locations":[]}]}],"tags":{},"tags_all":{},"trusted_key_groups":[],"trusted_signers":[],"viewer_certificate":[{}]}}},{"address":"module.cloudfront.aws_cloudfront_origin_access_identity.oai","module_address":"module.cloudfront","mode":"managed","type":"aws_cloudfront_origin_access_identity","name":"oai","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"comment":"OAI for cmmc-cloudfront"},"after_unknown":{"arn":true,"caller_reference":true,"cloudfront_access_identity_path":true,"etag":true,"iam_arn":true,"id":true,"s3_canonical_user_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.cloudtrail.aws_cloudtrail.main","module_address":"module.cloudtrail","mode":"managed","type":"aws_cloudtrail","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"advanced_event_selector":[],"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":true,"enable_logging":true,"event_selector":[{"data_resource":[{"type":"AWS::S3::Object","values":["arn:aws:s3:::"]}],"exclude_management_event_sources":null,"include_management_events":true,"read_write_type":"All"}],"include_global_service_events":true,"insight_selector":[],"is_multi_region_trail":true,"is_organization_trail":false,"name":"cmmc-trail","s3_bucket_name":"log_bucket","s3_key_prefix":null,"sns_topic_name":null},"after_unknown":{"advanced_event_selector":[],"arn":true,"event_selector":[{"data_resource":[{"values":[false]}]}],"home_region":true,"id":true,"insight_selector":[],"kms_key_id":true,"sns_topic_arn":true,"tags":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"advanced_event_selector":[],"event_selector":[{"data_resource":[{"values":[false]}]}],"insight_selector":[],"tags":{},"tags_all":{}}}},{"address":"module.compute.aws_iam_instance_profile.ec2_instance_profile","module_address":"module.compute","mode":"managed","type":"aws_iam_instance_profile","name":"ec2_instance_profile","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"cmmc-instance-profile","path":"/","role":"cmmc-ec2-role","tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"module.compute.aws_iam_role.ec2_role","module_address":"module.compute","mode":"managed","type":"aws_iam_role","name":"ec2_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cmmc-ec2-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}}},{"address":"module.compute.aws_iam_role_policy.ec2_policy","module_address":"module.compute","mode":"managed","type":"aws_iam_role_policy","name":"ec2_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"cmmc-ec2-policy"},"after_unknown":{"id":true,"name_prefix":true,"policy":true,"role":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.compute.aws_instance.cmmc_ec2","module_address":"module.compute","mode":"managed","type":"aws_instance","name":"cmmc_ec2","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"ami":"ami-0c55b159cbfafe1f0","credit_specification":[],"disable_api_termination":true,"ebs_block_device":[{"delete_on_termination":true,"device_name":"/dev/sda1","encrypted":true,"tags":null}],"get_password_data":false,"hibernation":null,"iam_instance_profile":"cmmc-instance-profile","instance_type":"t3.micro","launch_template":[],"metadata_options":[{"http_endpoint":"enabled","http_protocol_ipv6":"disabled","http_put_response_hop_limit":1,"http_tokens":"required"}],"monitoring":true,"source_dest_check":true,"timeouts":null,"user_data_base64":"IyEvYmluL2Jhc2gKeXVtIHVwZGF0ZSAteQphbWF6b24tbGludXgtZXh0cmFzIGVuYWJsZSBlcGVsCnl1bSBpbnN0YWxsIC15IGVwZWwtcmVsZWFzZQoKIyBJbnN0YWxsIEFwYWNoZQp5dW0gaW5zdGFsbCAteSBodHRwZApzeXN0ZW1jdGwgZW5hYmxlIGh0dHBkCnN5c3RlbWN0bCBzdGFydCBodHRwZAoKIyBJbnN0YWxsIENsb3VkV2F0Y2ggQWdlbnQKeXVtIGluc3RhbGwgLXkgYW1hem9uLWNsb3Vkd2F0Y2gtYWdlbnQKL29wdC9hd3MvYW1hem9uLWNsb3Vkd2F0Y2gtYWdlbnQvYmluL2FtYXpvbi1jbG91ZHdhdGNoLWFnZW50LWN0bCBcCiAgLWEgZmV0Y2gtY29uZmlnIC1tIGVjMiBcCiAgLWMgc3NtOkFtYXpvbkNsb3VkV2F0Y2gtbGludXgtY29uZmlnIFwKICAtcwoKIyBJbnN0YWxsIGFuZCBjb25maWd1cmUgU1NNIEFnZW50Cnl1bSBpbnN0YWxsIC15IGh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9lYzItZG93bmxvYWRzLXdpbmRvd3MvU1NNQWdlbnQvbGF0ZXN0L2xpbnV4X2FtZDY0L2FtYXpvbi1zc20tYWdlbnQucnBtCnN5c3RlbWN0bCBlbmFibGUgYW1hem9uLXNzbS1hZ2VudApzeXN0ZW1jdGwgc3RhcnQgYW1hem9uLXNzbS1hZ2VudAo=","user_data_replace_on_change":false,"volume_tags":null},"after_unknown":{"arn":true,"associate_public_ip_address":true,"availability_zone":true,"capacity_reservation_specification":true,"cpu_core_count":true,"cpu_options":true,"cpu_threads_per_core":true,"credit_specification":[],"disable_api_stop":true,"ebs_block_device":[{"iops":true,"kms_key_id":true,"snapshot_id":true,"tags_all":true,"throughput":true,"volume_id":true,"volume_size":true,"volume_type":true}],"ebs_optimized":true,"enable_primary_ipv6":true,"enclave_options":true,"ephemeral_block_device":true,"host_id":true,"host_resource_group_arn":true,"id":true,"instance_initiated_shutdown_behavior":true,"instance_lifecycle":true,"instance_market_options":true,"instance_state":true,"ipv6_address_count":true,"ipv6_addresses":true,"key_name":true,"launch_template":[],"maintenance_options":true,"metadata_options":[{"instance_metadata_tags":true}],"network_interface":true,"outpost_arn":true,"password_data":true,"placement_group":true,"placement_partition_number":true,"primary_network_interface_id":true,"private_dns":true,"private_dns_name_options":true,"private_ip":true,"public_dns":true,"public_ip":true,"root_block_device":true,"secondary_private_ips":true,"security_groups":true,"spot_instance_request_id":true,"subnet_id":true,"tags":true,"tags_all":true,"tenancy":true,"user_data":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"ebs_block_device":[{"tags_all":{}}],"enclave_options":[],"ephemeral_block_device":[],"instance_market_options":[],"ipv6_addresses":[],"launch_template":[],"maintenance_options":[],"metadata_options":[{}],"network_interface":[],"private_dns_name_options":[],"root_block_device":[],"secondary_private_ips":[],"security_groups":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}}},{"address":"module.config.aws_config_configuration_recorder.recorder","module_address":"module.config","mode":"managed","type":"aws_config_configuration_recorder","name":"recorder","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"cmmc-recorder","recording_group":[{"all_supported":true,"include_global_resource_types":true,"resource_types":null}]},"after_unknown":{"id":true,"recording_group":[{"exclusion_by_resource_types":true,"recording_strategy":true}],"recording_mode":true,"role_arn":true},"before_sensitive":false,"after_sensitive":{"recording_group":[{"exclusion_by_resource_types":[],"recording_strategy":[]}],"recording_mode":[]}}},{"address":"module.config.aws_config_delivery_channel.delivery","module_address":"module.config","mode":"managed","type":"aws_config_delivery_channel","name":"delivery","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"cmmc-delivery-channel","s3_bucket_name":"log_bucket","s3_key_prefix":null,"s3_kms_key_arn":null,"snapshot_delivery_properties":[{"delivery_frequency":"Six_Hours"}],"sns_topic_arn":null},"after_unknown":{"id":true,"snapshot_delivery_properties":[{}]},"before_sensitive":false,"after_sensitive":{"snapshot_delivery_properties":[{}]}}},{"address":"module.config.aws_iam_role.config_role","module_address":"module.config","mode":"managed","type":"aws_iam_role","name":"config_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"config.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cmmc-config-role","path":"/","permissions_boundary":null,"tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags_all":{}}}},{"address":"module.config.aws_iam_role_policy.config_policy","module_address":"module.config","mode":"managed","type":"aws_iam_role_policy","name":"config_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"cmmc-config-policy"},"after_unknown":{"id":true,"name_prefix":true,"policy":true,"role":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.kms.aws_kms_key.cmmc_kms","module_address":"module.kms","mode":"managed","type":"aws_kms_key","name":"cmmc_kms","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bypass_policy_lockout_safety_check":false,"custom_key_store_id":null,"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":30,"description":"CMMC-compliant KMS key for data encryption","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\"Statement\":[{\"Action\":[\"kms:Create*\",\"kms:Describe*\",\"kms:Enable*\",\"kms:List*\",\"kms:Put*\",\"kms:Update*\",\"kms:Revoke*\",\"kms:Disable*\",\"kms:Get*\",\"kms:Delete*\",\"kms:ScheduleKeyDeletion\",\"kms:CancelKeyDeletion\"],\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::905418409326:root\"},\"Resource\":\"*\",\"Sid\":\"AllowAdminKeyManagement\"},{\"Action\":[\"kms:GenerateDataKey*\",\"kms:Encrypt\",\"kms:Decrypt\",\"kms:ReEncrypt*\",\"kms:DescribeKey\"],\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Resource\":\"*\",\"Sid\":\"AllowCloudTrailKMSUsage\"}],\"Version\":\"2012-10-17\"}","timeouts":null,"xks_key_id":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"multi_region":true,"rotation_period_in_days":true,"tags":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.logging.aws_cloudwatch_log_group.cmmc_vpc_flow","module_address":"module.logging","mode":"managed","type":"aws_cloudwatch_log_group","name":"cmmc_vpc_flow","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":null,"name":"vpc-flow-logs","retention_in_days":90,"skip_destroy":false},"after_unknown":{"arn":true,"id":true,"log_group_class":true,"name_prefix":true,"tags":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.logging.aws_flow_log.vpc_flow_log","module_address":"module.logging","mode":"managed","type":"aws_flow_log","name":"vpc_flow_log","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deliver_cross_account_role":null,"destination_options":[],"eni_id":null,"log_destination_type":"cloud-watch-logs","log_format":"${timestamp} ${interface-id} ${srcaddr} ${dstaddr} ${protocol} ${packets} ${bytes} ${action} ${log-status}","max_aggregation_interval":600,"subnet_id":null,"tags":null,"tags_all":{"Environment":"production","Owner":"Coldchain Secure","Project":"CMMC Infra"},"traffic_type":"ALL","transit_gateway_attachment_id":null,"transit_gateway_id":null},"after_unknown":{"arn":true,"destination_options":[],"iam_role_arn":true,"id":true,"log_destination":true,"log_group_name":true,"tags_all":{},"vpc_id":true},"before_sensitive":false,"after_sensitive":{"destination_options":[],"tags_all":{}}}},{"address":"module.logging.aws_iam_role.cmmc_flow_role","module_address":"module.logging","mode":"managed","type":"aws_iam_role","name":"cmmc_flow_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"vpc-flow-logs.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cmmc-flow-role","path":"/","permissions_boundary":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"name_prefix":true,"tags":true,"tags_all":true,"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}}},{"address":"module.logging.aws_iam_role_policy.cmmc_flow_policy","module_address":"module.logging","mode":"managed","type":"aws_iam_role_policy","name":"cmmc_flow_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"cmmc_flow_log_policy"},"after_unknown":{"id":true,"name_prefix":true,"policy":true,"role":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.networking.aws_internet_gateway.igw","module_address":"module.networking","mode":"managed","type":"aws_internet_gateway","name":"igw","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"tags":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.networking.aws_route_table.rt","module_address":"module.networking","mode":"managed","type":"aws_route_table","name":"rt","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"route":[{"carrier_gateway_id":"","cidr_block":"0.0.0.0/0","core_network_arn":"","destination_prefix_list_id":"","egress_only_gateway_id":"","ipv6_cidr_block":"","local_gateway_id":"","nat_gateway_id":"","network_interface_id":"","transit_gateway_id":"","vpc_endpoint_id":"","vpc_peering_connection_id":""}],"timeouts":null},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":[{"gateway_id":true}],"tags":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"propagating_vgws":[],"route":[{}],"tags":{},"tags_all":{}}}},{"address":"module.networking.aws_route_table_association.rta_a","module_address":"module.networking","mode":"managed","type":"aws_route_table_association","name":"rta_a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.networking.aws_route_table_association.rta_b","module_address":"module.networking","mode":"managed","type":"aws_route_table_association","name":"rta_b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.networking.aws_security_group.main_sg","module_address":"module.networking","mode":"managed","type":"aws_security_group","name":"main_sg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Main security group","egress":[{"cidr_blocks":["0.0.0.0/0"],"description":"Allow all outbound","from_port":0,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":false,"to_port":0},{"cidr_blocks":[],"description":"Allow internal SG egress","from_port":443,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443}],"ingress":[{"cidr_blocks":["10.0.10.0/24"],"description":"Allow SSH from Admin VPN","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22},{"cidr_blocks":["203.0.113.0/24"],"description":"Allow HTTPS","from_port":443,"ipv6_cidr_blocks":["::/0"],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":443},{"cidr_blocks":[],"description":"Internal SG Communication","from_port":8080,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":8080}],"name":"cmmc-vpc-sg","revoke_rules_on_delete":false,"timeouts":null},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"id":true,"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"name_prefix":true,"owner_id":true,"tags":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[false],"ipv6_cidr_blocks":[false],"prefix_list_ids":[],"security_groups":[]},{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"tags":{},"tags_all":{}}}},{"address":"module.networking.aws_subnet.subnet_a","module_address":"module.networking","mode":"managed","type":"aws_subnet","name":"subnet_a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1a","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.networking.aws_subnet.subnet_b","module_address":"module.networking","mode":"managed","type":"aws_subnet","name":"subnet_b","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"us-east-1b","cidr_block":"10.0.2.0/24","customer_owned_ipv4_pool":null,"enable_dns64":false,"enable_lni_at_device_index":null,"enable_resource_name_dns_a_record_on_launch":false,"enable_resource_name_dns_aaaa_record_on_launch":false,"ipv6_cidr_block":null,"ipv6_native":false,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"timeouts":null},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"private_dns_hostname_type_on_launch":true,"tags":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.networking.aws_vpc.main","module_address":"module.networking","mode":"managed","type":"aws_vpc","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_generated_ipv6_cidr_block":null,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","ipv4_ipam_pool_id":null,"ipv4_netmask_length":null,"ipv6_ipam_pool_id":null,"ipv6_netmask_length":null},"after_unknown":{"arn":true,"default_network_acl_id":true,"default_route_table_id":true,"default_security_group_id":true,"dhcp_options_id":true,"enable_network_address_usage_metrics":true,"id":true,"ipv6_association_id":true,"ipv6_cidr_block":true,"ipv6_cidr_block_network_border_group":true,"main_route_table_id":true,"owner_id":true,"tags":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"module.rds.aws_db_instance.postgres","module_address":"module.rds","mode":"managed","type":"aws_db_instance","name":"postgres","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allocated_storage":20,"allow_major_version_upgrade":null,"apply_immediately":false,"auto_minor_version_upgrade":true,"blue_green_update":[],"copy_tags_to_snapshot":false,"custom_iam_instance_profile":null,"customer_owned_ip_enabled":null,"db_subnet_group_name":"cmmc-db-subnet","dedicated_log_volume":false,"delete_automated_backups":true,"deletion_protection":null,"domain":null,"domain_auth_secret_arn":null,"domain_dns_ips":null,"domain_iam_role_name":null,"domain_ou":null,"enabled_cloudwatch_logs_exports":null,"engine":"postgres","engine_version":"13.4","final_snapshot_identifier":null,"iam_database_authentication_enabled":null,"identifier":"cmmc-postgres","instance_class":"db.t3.small","manage_master_user_password":null,"max_allocated_storage":null,"monitoring_interval":0,"password":"YourSecurePasswordHere!","password_wo":null,"password_wo_version":null,"performance_insights_enabled":false,"publicly_accessible":false,"replicate_source_db":null,"restore_to_point_in_time":[],"s3_import":[],"skip_final_snapshot":true,"storage_encrypted":true,"timeouts":null,"upgrade_storage_config":null,"username":"dbadmin"},"after_unknown":{"address":true,"arn":true,"availability_zone":true,"backup_retention_period":true,"backup_target":true,"backup_window":true,"blue_green_update":[],"ca_cert_identifier":true,"character_set_name":true,"database_insights_mode":true,"db_name":true,"domain_fqdn":true,"endpoint":true,"engine_lifecycle_support":true,"engine_version_actual":true,"hosted_zone_id":true,"id":true,"identifier_prefix":true,"iops":true,"kms_key_id":true,"latest_restorable_time":true,"license_model":true,"listener_endpoint":true,"maintenance_window":true,"master_user_secret":true,"master_user_secret_kms_key_id":true,"monitoring_role_arn":true,"multi_az":true,"nchar_character_set_name":true,"network_type":true,"option_group_name":true,"parameter_group_name":true,"performance_insights_kms_key_id":true,"performance_insights_retention_period":true,"port":true,"replica_mode":true,"replicas":true,"resource_id":true,"restore_to_point_in_time":[],"s3_import":[],"snapshot_identifier":true,"status":true,"storage_throughput":true,"storage_type":true,"tags":true,"tags_all":true,"timezone":true,"vpc_security_group_ids":true},"before_sensitive":false,"after_sensitive":{"blue_green_update":[],"listener_endpoint":[],"master_user_secret":[],"password":true,"password_wo":true,"replicas":[],"restore_to_point_in_time":[],"s3_import":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[]}}},{"address":"module.rds.aws_db_subnet_group.db_subnet_group","module_address":"module.rds","mode":"managed","type":"aws_db_subnet_group","name":"db_subnet_group","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","name":"cmmc-db-subnet"},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"subnet_ids":true,"supported_network_types":true,"tags":true,"tags_all":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"subnet_ids":[],"supported_network_types":[],"tags":{},"tags_all":{}}}},{"address":"module.route53.aws_route53_zone.new_zone[0]","module_address":"module.route53","mode":"managed","type":"aws_route53_zone","name":"new_zone","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"comment":"Managed by Terraform","delegation_set_id":null,"force_destroy":false,"name":"example.cmmcsecure.com","tags":{"Name":"example.cmmcsecure.com-zone"},"tags_all":{"Environment":"production","Name":"example.cmmcsecure.com-zone","Owner":"Coldchain Secure","Project":"CMMC Infra"},"timeouts":null,"vpc":[]},"after_unknown":{"arn":true,"id":true,"name_servers":true,"primary_name_server":true,"tags":{},"tags_all":{},"vpc":[],"zone_id":true},"before_sensitive":false,"after_sensitive":{"name_servers":[],"tags":{},"tags_all":{},"vpc":[]}}},{"address":"module.s3.aws_s3_bucket.data","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket","name":"data","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"data_bucket","force_destroy":false,"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":true,"tags_all":true,"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}}},{"address":"module.s3.aws_s3_bucket.logs","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"log_bucket","force_destroy":false,"timeouts":null},"after_unknown":{"acceleration_status":true,"acl":true,"arn":true,"bucket_domain_name":true,"bucket_prefix":true,"bucket_regional_domain_name":true,"cors_rule":true,"grant":true,"hosted_zone_id":true,"id":true,"lifecycle_rule":true,"logging":true,"object_lock_configuration":true,"object_lock_enabled":true,"policy":true,"region":true,"replication_configuration":true,"request_payer":true,"server_side_encryption_configuration":true,"tags":true,"tags_all":true,"versioning":true,"website":true,"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"tags":{},"tags_all":{},"versioning":[],"website":[]}}},{"address":"module.s3.aws_s3_bucket_acl.data_acl","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_acl","name":"data_acl","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","expected_bucket_owner":null},"after_unknown":{"access_control_policy":true,"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{"access_control_policy":[]}}},{"address":"module.s3.aws_s3_bucket_acl.logs_acl","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_acl","name":"logs_acl","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","expected_bucket_owner":null},"after_unknown":{"access_control_policy":true,"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{"access_control_policy":[]}}},{"address":"module.s3.aws_s3_bucket_policy.data_policy","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_policy","name":"data_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.s3.aws_s3_bucket_policy.logs_policy","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_policy","name":"logs_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{},"after_unknown":{"bucket":true,"id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.s3.aws_s3_bucket_public_access_block.data_block","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"data_block","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.s3.aws_s3_bucket_public_access_block.logs_block","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs_block","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"bucket":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.s3.aws_s3_bucket_server_side_encryption_configuration.data_encryption","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"data_encryption","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":true}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"module.s3.aws_s3_bucket_server_side_encryption_configuration.logs_encryption","module_address":"module.s3","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs_encryption","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"expected_bucket_owner":null,"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":"aws:kms"}],"bucket_key_enabled":null}]},"after_unknown":{"bucket":true,"id":true,"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":true}]}]},"before_sensitive":false,"after_sensitive":{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}}},{"address":"module.waf.aws_wafv2_web_acl.cloudfront_acl","module_address":"module.waf","mode":"managed","type":"aws_wafv2_web_acl","name":"cloudfront_acl","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"description":"WAF for CloudFront distribution","name":"cloudfront-waf-acl","rule":[{"action":[],"captcha_config":[],"challenge_config":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":1,"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"name":"AWSManagedRulesCommonRuleSet","rule_action_override":[],"scope_down_statement":[],"vendor_name":"AWS","version":""}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]}],"rule_json":null,"scope":"CLOUDFRONT","token_domains":null,"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"cloudfront-waf","sampled_requests_enabled":true}]},"after_unknown":{"application_integration_url":true,"arn":true,"association_config":[],"capacity":true,"captcha_config":[],"challenge_config":[],"custom_response_body":[],"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"id":true,"lock_token":true,"name_prefix":true,"rule":[{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":true,"tags_all":true,"visibility_config":[{}]},"before_sensitive":false,"after_sensitive":{"association_config":[],"captcha_config":[],"challenge_config":[],"custom_response_body":[],"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"rule":[{"action":[],"captcha_config":[],"challenge_config":[],"override_action":[{"count":[],"none":[{}]}],"rule_label":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"label_match_statement":[],"managed_rule_group_statement":[{"managed_rule_group_configs":[],"rule_action_override":[],"scope_down_statement":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_match_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}}],"output_changes":{"acm_certificate_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"aws_config_delivery_channel":{"actions":["create"],"before":null,"after":"cmmc-delivery-channel","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"aws_config_recorder_name":{"actions":["create"],"before":null,"after":"cmmc-recorder","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"cloudfront_distribution_domain":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"cloudfront_distribution_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"data_bucket_name":{"actions":["create"],"before":null,"after":"data_bucket","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"ec2_instance_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"ec2_public_ip":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"flow_log_group_name":{"actions":["create"],"before":null,"after":{"kms_key_id":null,"name":"vpc-flow-logs","retention_in_days":90,"skip_destroy":false},"after_unknown":{"arn":true,"id":true,"log_group_class":true,"name_prefix":true,"tags":true,"tags_all":true},"before_sensitive":false,"after_sensitive":false},"flow_log_role_name":{"actions":["create"],"before":null,"after":"cmmc-flow-role","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"kms_key_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"kms_key_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"log_bucket_name":{"actions":["create"],"before":null,"after":"log_bucket","after_unknown":false,"before_sensitive":false,"after_sensitive":false},"rds_endpoint":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"rds_instance_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"route53_zone_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"security_group_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"subnet_a_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"subnet_b_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"subnet_ids":{"actions":["create"],"before":null,"after":[null,null],"after_unknown":[true,true],"before_sensitive":false,"after_sensitive":false},"vpc_id":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false},"waf_acl_arn":{"actions":["create"],"before":null,"after_unknown":true,"before_sensitive":false,"after_sensitive":false}},"prior_state":{"format_version":"1.0","terraform_version":"1.12.1","values":{"outputs":{"aws_config_delivery_channel":{"sensitive":false,"value":"cmmc-delivery-channel","type":"string"},"aws_config_recorder_name":{"sensitive":false,"value":"cmmc-recorder","type":"string"},"data_bucket_name":{"sensitive":false,"value":"data_bucket","type":"string"},"flow_log_role_name":{"sensitive":false,"value":"cmmc-flow-role","type":"string"},"log_bucket_name":{"sensitive":false,"value":"log_bucket","type":"string"}},"root_module":{"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"905418409326","arn":"arn:aws:iam::905418409326:root","id":"905418409326","user_id":"905418409326"},"sensitive_values":{}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","version_constraint":"\u003e= 5.92.0","expressions":{"default_tags":[{"tags":{"references":["var.project","var.owner","var.environment"]}}],"region":{"references":["var.region"]}}},"random":{"name":"random","full_name":"registry.terraform.io/hashicorp/random","version_constraint":"\u003e= 3.7.1"}},"root_module":{"outputs":{"acm_certificate_arn":{"expression":{"references":["module.acm.acm_certificate_arn","module.acm"]}},"aws_config_delivery_channel":{"expression":{"references":["module.config.config_delivery_channel","module.config"]}},"aws_config_recorder_name":{"expression":{"references":["module.config.config_recorder_name","module.config"]}},"cloudfront_distribution_domain":{"expression":{"references":["module.cloudfront.cloudfront_distribution_domain","module.cloudfront"]},"description":"CloudFront distribution domain name"},"cloudfront_distribution_id":{"expression":{"references":["module.cloudfront.cloudfront_distribution_id","module.cloudfront"]},"description":"CloudFront distribution ID"},"data_bucket_name":{"expression":{"references":["module.s3.data_bucket_name","module.s3"]}},"ec2_instance_id":{"expression":{"references":["module.compute.instance_id","module.compute"]}},"ec2_public_ip":{"expression":{"references":["module.compute.public_ip","module.compute"]}},"flow_log_group_name":{"expression":{"references":["module.logging.flow_log_group_name","module.logging"]},"description":"The name of the CloudWatch Log Group for flow logs."},"flow_log_role_name":{"expression":{"references":["module.logging.flow_log_role_name","module.logging"]},"description":"IAM Role name for flow logs."},"kms_key_arn":{"expression":{"references":["module.kms.kms_key_arn","module.kms"]}},"kms_key_id":{"expression":{"references":["module.kms.kms_key_id","module.kms"]}},"log_bucket_name":{"expression":{"references":["module.s3.log_bucket_name","module.s3"]}},"rds_endpoint":{"expression":{"references":["module.rds.db_endpoint","module.rds"]}},"rds_instance_id":{"expression":{"references":["module.rds.db_instance_id","module.rds"]}},"route53_zone_id":{"expression":{"references":["module.route53.zone_id","module.route53"]}},"security_group_id":{"expression":{"references":["module.networking.security_group_id","module.networking"]}},"subnet_a_id":{"expression":{"references":["module.networking.subnet_a_id","module.networking"]}},"subnet_b_id":{"expression":{"references":["module.networking.subnet_b_id","module.networking"]}},"subnet_ids":{"expression":{"references":["module.networking.subnet_ids","module.networking"]}},"vpc_id":{"expression":{"references":["module.networking.vpc_id","module.networking"]}},"waf_acl_arn":{"expression":{"references":["module.waf.waf_acl_arn","module.waf"]}}},"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0}],"module_calls":{"acm":{"source":"./modules/acm","expressions":{"common_tags":{"references":["local.common_tags"]},"domain_name":{"references":["var.cloudfront_domain_aliases[0]","var.cloudfront_domain_aliases"]},"route53_zone_id":{"references":["module.route53.zone_id","module.route53"]},"subject_alternative_names":{"references":["var.cloudfront_domain_aliases"]}},"module":{"outputs":{"acm_certificate_arn":{"expression":{"references":["aws_acm_certificate.cloudfront_cert.arn","aws_acm_certificate.cloudfront_cert"]}}},"resources":[{"address":"aws_acm_certificate.cloudfront_cert","mode":"managed","type":"aws_acm_certificate","name":"cloudfront_cert","provider_config_key":"aws","expressions":{"domain_name":{"references":["var.domain_name"]},"subject_alternative_names":{"references":["var.subject_alternative_names"]},"tags":{"references":["var.common_tags"]},"validation_method":{"constant_value":"DNS"}},"schema_version":0},{"address":"aws_acm_certificate_validation.cert","mode":"managed","type":"aws_acm_certificate_validation","name":"cert","provider_config_key":"aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.cloudfront_cert.arn","aws_acm_certificate.cloudfront_cert"]},"validation_record_fqdns":{"references":["aws_route53_record.cert_validation"]}},"schema_version":0},{"address":"aws_route53_record.cert_validation","mode":"managed","type":"aws_route53_record","name":"cert_validation","provider_config_key":"aws","expressions":{"name":{"references":["each.value.name","each.value"]},"records":{"references":["each.value.value","each.value"]},"ttl":{"constant_value":60},"type":{"references":["each.value.type","each.value"]},"zone_id":{"references":["var.route53_zone_id"]}},"schema_version":2,"for_each_expression":{"references":["aws_acm_certificate.cloudfront_cert.domain_validation_options","aws_acm_certificate.cloudfront_cert"]}}],"variables":{"common_tags":{},"domain_name":{"description":"Primary domain name for ACM certificate"},"route53_zone_id":{},"subject_alternative_names":{"default":[],"description":"Alternative domain names for the certificate"}}}},"cloudfront":{"source":"./modules/cloudfront","expressions":{"cloudfront_acm_certificate_arn":{"references":["module.acm.acm_certificate_arn","module.acm"]},"cloudfront_domain_aliases":{"references":["var.cloudfront_domain_aliases"]},"cloudfront_waf_web_acl_id":{"references":["module.waf.cloudfront_waf_web_acl_id","module.waf"]},"common_tags":{"references":["local.common_tags"]},"origin_bucket_name":{"references":["var.data_bucket_name","var.region"]}},"module":{"outputs":{"cloudfront_distribution_arn":{"expression":{"references":["aws_cloudfront_distribution.secure_distribution.arn","aws_cloudfront_distribution.secure_distribution"]},"description":"CloudFront distribution ARN"},"cloudfront_distribution_domain":{"expression":{"references":["aws_cloudfront_distribution.secure_distribution.domain_name","aws_cloudfront_distribution.secure_distribution"]},"description":"CloudFront distribution domain name"},"cloudfront_distribution_id":{"expression":{"references":["aws_cloudfront_distribution.secure_distribution.id","aws_cloudfront_distribution.secure_distribution"]},"description":"CloudFront distribution ID"},"cloudfront_oai_id":{"expression":{"references":["aws_cloudfront_origin_access_identity.oai.id","aws_cloudfront_origin_access_identity.oai"]}},"cloudfront_oai_path":{"expression":{"references":["aws_cloudfront_origin_access_identity.oai.cloudfront_access_identity_path","aws_cloudfront_origin_access_identity.oai"]}}},"resources":[{"address":"aws_cloudfront_distribution.secure_distribution","mode":"managed","type":"aws_cloudfront_distribution","name":"secure_distribution","provider_config_key":"aws","expressions":{"aliases":{"references":["var.cloudfront_domain_aliases"]},"comment":{"constant_value":"CMMC-secure CloudFront distribution"},"default_cache_behavior":[{"allowed_methods":{"constant_value":["GET","HEAD"]},"cached_methods":{"constant_value":["GET","HEAD"]},"default_ttl":{"constant_value":3600},"forwarded_values":[{"cookies":[{"forward":{"constant_value":"none"}}],"query_string":{"constant_value":false}}],"max_ttl":{"constant_value":86400},"min_ttl":{"constant_value":0},"target_origin_id":{"constant_value":"s3-origin"},"viewer_protocol_policy":{"constant_value":"redirect-to-https"}}],"default_root_object":{"constant_value":"index.html"},"enabled":{"constant_value":true},"is_ipv6_enabled":{"constant_value":true},"origin":[{"domain_name":{"references":["var.origin_bucket_name"]},"origin_id":{"constant_value":"s3-origin"},"s3_origin_config":[{"origin_access_identity":{"references":["aws_cloudfront_origin_access_identity.oai.cloudfront_access_identity_path","aws_cloudfront_origin_access_identity.oai"]}}]}],"restrictions":[{"geo_restriction":[{"restriction_type":{"constant_value":"none"}}]}],"tags":{"references":["var.common_tags"]},"viewer_certificate":[{"acm_certificate_arn":{"references":["var.cloudfront_acm_certificate_arn"]},"minimum_protocol_version":{"constant_value":"TLSv1.2_2021"},"ssl_support_method":{"constant_value":"sni-only"}}],"web_acl_id":{"references":["var.cloudfront_waf_web_acl_id"]}},"schema_version":1},{"address":"aws_cloudfront_origin_access_identity.oai","mode":"managed","type":"aws_cloudfront_origin_access_identity","name":"oai","provider_config_key":"aws","expressions":{"comment":{"references":["var.common_tags[\"Name\"]","var.common_tags"]}},"schema_version":0}],"variables":{"cloudfront_acm_certificate_arn":{"default":null},"cloudfront_domain_aliases":{"default":[],"description":"A list of CNAMEs (aliases) to associate with the distribution."},"cloudfront_waf_web_acl_id":{"default":null,"description":"The WAF Web ACL ID to associate with this distribution."},"common_tags":{"description":"Common tags to apply to all resources"},"origin_bucket_name":{"description":"The domain name of the S3 bucket origin (e.g., \u003cbucket\u003e.s3.amazonaws.com)"}}}},"cloudtrail":{"source":"./modules/cloudtrail","expressions":{"common_tags":{"references":["local.common_tags"]},"kms_key_id":{"references":["module.kms.kms_key_id","module.kms"]},"log_bucket_name":{"references":["var.log_bucket_name"]}},"module":{"outputs":{"cloudtrail_arn":{"expression":{"references":["aws_cloudtrail.main.arn","aws_cloudtrail.main"]}}},"resources":[{"address":"aws_cloudtrail.main","mode":"managed","type":"aws_cloudtrail","name":"main","provider_config_key":"aws","expressions":{"enable_log_file_validation":{"constant_value":true},"event_selector":[{"data_resource":[{"type":{"constant_value":"AWS::S3::Object"},"values":{"constant_value":["arn:aws:s3:::"]}}],"include_management_events":{"constant_value":true},"read_write_type":{"constant_value":"All"}}],"include_global_service_events":{"constant_value":true},"is_multi_region_trail":{"constant_value":true},"kms_key_id":{"references":["var.kms_key_id"]},"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"s3_bucket_name":{"references":["var.log_bucket_name"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.common_tags"]}},"schema_version":1}],"variables":{"common_tags":{"default":{}},"kms_key_id":{},"log_bucket_name":{}}}},"compute":{"source":"./modules/compute","expressions":{"ami_id":{"references":["var.ami_id"]},"common_tags":{"references":["local.common_tags"]},"data_bucket_arn":{"references":["module.s3.data_bucket_arn","module.s3"]},"ebs_device_name":{"references":["var.ebs_device_name"]},"environment":{"references":["var.environment"]},"instance_type":{"references":["var.instance_type"]},"kms_key_arn":{"references":["module.kms.kms_key_arn","module.kms"]},"security_group_ids":{"references":["module.networking.security_group_id","module.networking"]},"subnet_id":{"references":["module.networking.subnet_a_id","module.networking"]}},"module":{"outputs":{"instance_id":{"expression":{"references":["aws_instance.cmmc_ec2.id","aws_instance.cmmc_ec2"]},"description":"The ID of the EC2 instance"},"instance_profile":{"expression":{"references":["aws_iam_instance_profile.ec2_instance_profile.name","aws_iam_instance_profile.ec2_instance_profile"]},"description":"IAM instance profile name"},"private_ip":{"expression":{"references":["aws_instance.cmmc_ec2.private_ip","aws_instance.cmmc_ec2"]},"description":"Private IP address of the EC2 instance"},"public_ip":{"expression":{"references":["aws_instance.cmmc_ec2.public_ip","aws_instance.cmmc_ec2"]},"description":"Public IP address of the EC2 instance"}},"resources":[{"address":"aws_iam_instance_profile.ec2_instance_profile","mode":"managed","type":"aws_iam_instance_profile","name":"ec2_instance_profile","provider_config_key":"aws","expressions":{"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"role":{"references":["aws_iam_role.ec2_role.name","aws_iam_role.ec2_role"]}},"schema_version":0},{"address":"aws_iam_role.ec2_role","mode":"managed","type":"aws_iam_role","name":"ec2_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]}},"schema_version":0},{"address":"aws_iam_role_policy.ec2_policy","mode":"managed","type":"aws_iam_role_policy","name":"ec2_policy","provider_config_key":"aws","expressions":{"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"policy":{"references":["var.data_bucket_arn","var.data_bucket_arn"]},"role":{"references":["aws_iam_role.ec2_role.id","aws_iam_role.ec2_role"]}},"schema_version":0},{"address":"aws_instance.cmmc_ec2","mode":"managed","type":"aws_instance","name":"cmmc_ec2","provider_config_key":"aws","expressions":{"ami":{"references":["var.ami_id"]},"disable_api_termination":{"constant_value":true},"ebs_block_device":[{"device_name":{"references":["var.ebs_device_name"]},"encrypted":{"constant_value":true},"kms_key_id":{"references":["var.kms_key_arn"]}}],"iam_instance_profile":{"references":["aws_iam_instance_profile.ec2_instance_profile.name","aws_iam_instance_profile.ec2_instance_profile"]},"instance_type":{"references":["var.instance_type"]},"metadata_options":[{"http_endpoint":{"constant_value":"enabled"},"http_put_response_hop_limit":{"constant_value":1},"http_tokens":{"constant_value":"required"}}],"monitoring":{"constant_value":true},"source_dest_check":{"constant_value":true},"subnet_id":{"references":["var.subnet_id"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.environment","var.common_tags"]},"user_data_base64":{"references":["var.user_data_script_path"]},"vpc_security_group_ids":{"references":["var.security_group_ids"]}},"schema_version":1}],"variables":{"ami_id":{"description":"AMI ID for EC2 instance"},"common_tags":{"description":"Common tags to apply to all resources"},"data_bucket_arn":{"description":"ARN of the S3 data bucket the EC2 instance needs access to"},"ebs_device_name":{"description":"The name of the EBS device attached to the EC2 instance"},"enable_cloudwatch_agent":{"default":true,"description":"Toggle for enabling CloudWatch agent installation"},"enable_ssm_agent":{"default":true,"description":"Toggle for enabling SSM agent and patch compliance"},"environment":{"description":"Deployment environment"},"instance_type":{"default":"t3.micro","description":"EC2 instance type"},"kms_key_arn":{"description":"KMS key ARN for EBS encryption"},"security_group_ids":{"description":"List of security group IDs to associate with EC2"},"subnet_id":{"description":"Subnet ID for EC2 instance"},"user_data_script_path":{"default":"scripts/ec2_user_data.sh","description":"Path to the EC2 user data script"}}}},"config":{"source":"./modules/config","expressions":{"common_tags":{"references":["local.common_tags"]},"log_bucket_arn":{"references":["module.s3.log_bucket_arn","module.s3"]},"log_bucket_name":{"references":["var.log_bucket_name"]}},"module":{"outputs":{"config_delivery_channel":{"expression":{"references":["aws_config_delivery_channel.delivery.name","aws_config_delivery_channel.delivery"]},"description":"AWS Config delivery channel name"},"config_recorder_name":{"expression":{"references":["aws_config_configuration_recorder.recorder.name","aws_config_configuration_recorder.recorder"]},"description":"AWS Config recorder name"},"config_role_arn":{"expression":{"references":["aws_iam_role.config_role.arn","aws_iam_role.config_role"]},"description":"IAM Role ARN used by AWS Config"}},"resources":[{"address":"aws_config_configuration_recorder.recorder","mode":"managed","type":"aws_config_configuration_recorder","name":"recorder","provider_config_key":"aws","expressions":{"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"recording_group":[{"all_supported":{"constant_value":true},"include_global_resource_types":{"constant_value":true}}],"role_arn":{"references":["aws_iam_role.config_role.arn","aws_iam_role.config_role"]}},"schema_version":0},{"address":"aws_config_delivery_channel.delivery","mode":"managed","type":"aws_config_delivery_channel","name":"delivery","provider_config_key":"aws","expressions":{"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"s3_bucket_name":{"references":["var.log_bucket_name"]},"snapshot_delivery_properties":[{"delivery_frequency":{"constant_value":"Six_Hours"}}]},"schema_version":0,"depends_on":["aws_config_configuration_recorder.recorder"]},{"address":"aws_iam_role.config_role","mode":"managed","type":"aws_iam_role","name":"config_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]}},"schema_version":0},{"address":"aws_iam_role_policy.config_policy","mode":"managed","type":"aws_iam_role_policy","name":"config_policy","provider_config_key":"aws","expressions":{"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"policy":{"references":["var.log_bucket_arn"]},"role":{"references":["aws_iam_role.config_role.id","aws_iam_role.config_role"]}},"schema_version":0}],"variables":{"common_tags":{"description":"Common tags to apply to all resources"},"log_bucket_arn":{"description":"ARN of the S3 log bucket used by AWS Config"},"log_bucket_name":{"description":"Name of the S3 bucket for AWS Config delivery"}}}},"kms":{"source":"./modules/kms","expressions":{"account_id":{"references":["data.aws_caller_identity.current.account_id","data.aws_caller_identity.current"]},"common_tags":{"references":["local.common_tags"]},"environment":{"references":["var.environment"]},"name_prefix":{"references":["local.name_prefix"]}},"module":{"outputs":{"kms_key_arn":{"expression":{"references":["aws_kms_key.cmmc_kms.arn","aws_kms_key.cmmc_kms"]},"description":"KMS Key ARN"},"kms_key_id":{"expression":{"references":["aws_kms_key.cmmc_kms.key_id","aws_kms_key.cmmc_kms"]},"description":"KMS Key ID"}},"resources":[{"address":"aws_kms_key.cmmc_kms","mode":"managed","type":"aws_kms_key","name":"cmmc_kms","provider_config_key":"aws","expressions":{"deletion_window_in_days":{"constant_value":30},"description":{"constant_value":"CMMC-compliant KMS key for data encryption"},"enable_key_rotation":{"constant_value":true},"policy":{"references":["var.account_id"]},"tags":{"references":["var.name_prefix","var.environment","var.common_tags"]}},"schema_version":0}],"variables":{"account_id":{"description":"AWS Account ID for KMS policy"},"common_tags":{"description":"Common tags to apply to all resources"},"environment":{"description":"Environment tag (e.g., production)"},"name_prefix":{"description":"Prefix for KMS key name"}}}},"logging":{"source":"./modules/logging","expressions":{"common_tags":{"references":["local.common_tags"]},"environment":{"references":["var.environment"]},"flow_log_group_arn":{"references":["module.logging.flow_log_group_arn","module.logging"]},"flow_log_group_name":{"references":["var.flow_log_group_name"]},"flow_log_role_name":{"references":["var.flow_log_role_name"]},"retention_in_days":{"references":["var.retention_in_days"]},"vpc_id":{"references":["module.networking.vpc_id","module.networking"]}},"module":{"outputs":{"flow_log_group_arn":{"expression":{"references":["aws_cloudwatch_log_group.cmmc_vpc_flow.arn","aws_cloudwatch_log_group.cmmc_vpc_flow"]},"description":"ARN of the CloudWatch Log Group for VPC Flow Logs"},"flow_log_group_name":{"expression":{"references":["aws_cloudwatch_log_group.cmmc_vpc_flow"]},"description":"The name of the CloudWatch Log Group for flow logs."},"flow_log_id":{"expression":{"references":["aws_flow_log.vpc_flow_log.id","aws_flow_log.vpc_flow_log"]},"description":"The ID of the VPC flow log"},"flow_log_role_name":{"expression":{"references":["aws_iam_role.cmmc_flow_role.name","aws_iam_role.cmmc_flow_role"]},"description":"IAM Role name for flow logs."},"log_group_name":{"expression":{"references":["aws_cloudwatch_log_group.cmmc_vpc_flow.name","aws_cloudwatch_log_group.cmmc_vpc_flow"]},"description":"The name of the VPC flow log group"}},"resources":[{"address":"aws_cloudwatch_log_group.cmmc_vpc_flow","mode":"managed","type":"aws_cloudwatch_log_group","name":"cmmc_vpc_flow","provider_config_key":"aws","expressions":{"name":{"references":["var.flow_log_group_name"]},"retention_in_days":{"references":["var.retention_in_days"]},"tags":{"references":["var.environment","var.common_tags"]}},"schema_version":0},{"address":"aws_flow_log.vpc_flow_log","mode":"managed","type":"aws_flow_log","name":"vpc_flow_log","provider_config_key":"aws","expressions":{"iam_role_arn":{"references":["aws_iam_role.cmmc_flow_role.arn","aws_iam_role.cmmc_flow_role"]},"log_destination":{"references":["var.flow_log_group_arn"]},"log_destination_type":{"constant_value":"cloud-watch-logs"},"log_format":{"constant_value":"${timestamp} ${interface-id} ${srcaddr} ${dstaddr} ${protocol} ${packets} ${bytes} ${action} ${log-status}"},"traffic_type":{"constant_value":"ALL"},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":0},{"address":"aws_iam_role.cmmc_flow_role","mode":"managed","type":"aws_iam_role","name":"cmmc_flow_role","provider_config_key":"aws","expressions":{"assume_role_policy":{},"name":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.flow_log_role_name"]},"tags":{"references":["var.environment","var.common_tags"]}},"schema_version":0},{"address":"aws_iam_role_policy.cmmc_flow_policy","mode":"managed","type":"aws_iam_role_policy","name":"cmmc_flow_policy","provider_config_key":"aws","expressions":{"name":{"constant_value":"cmmc_flow_log_policy"},"policy":{"references":["var.flow_log_group_arn"]},"role":{"references":["aws_iam_role.cmmc_flow_role.id","aws_iam_role.cmmc_flow_role"]}},"schema_version":0}],"variables":{"common_tags":{"description":"Common tags to apply to all resources"},"environment":{"description":"Environment tag."},"flow_log_group_arn":{"description":"ARN of the CloudWatch Log Group for VPC Flow Logs"},"flow_log_group_name":{"description":"The name of the CloudWatch Log Group for flow logs."},"flow_log_role_name":{"description":"IAM Role name for flow logs."},"retention_in_days":{"description":"Number of days to retain logs"},"vpc_id":{"description":"The ID of the VPC to attach flow logs to."}}}},"networking":{"source":"./modules/networking","expressions":{"availability_zone_a":{"references":["var.availability_zone_a"]},"availability_zone_b":{"references":["var.availability_zone_b"]},"common_tags":{"references":["local.common_tags"]},"environment":{"references":["var.environment"]},"region":{"references":["var.region"]},"route_cidr_block":{"references":["var.route_cidr_block"]},"security_group_egress_rules":{"references":["var.security_group_egress_rules"]},"security_group_ingress_rules":{"references":["var.security_group_ingress_rules"]},"subnet_cidr_a":{"references":["var.subnet_cidr_a"]},"subnet_cidr_b":{"references":["var.subnet_cidr_b"]},"trusted_ip_range":{"references":["var.trusted_ip_range"]},"vpc_cidr":{"references":["var.vpc_cidr"]},"vpc_name":{"references":["var.vpc_name"]}},"module":{"outputs":{"security_group_id":{"expression":{"references":["aws_security_group.main_sg.id","aws_security_group.main_sg"]},"description":"ID of the default security group"},"subnet_a_id":{"expression":{"references":["aws_subnet.subnet_a.id","aws_subnet.subnet_a"]},"description":"Subnet A ID"},"subnet_b_id":{"expression":{"references":["aws_subnet.subnet_b.id","aws_subnet.subnet_b"]},"description":"Subnet B ID"},"subnet_ids":{"expression":{"references":["aws_subnet.subnet_a.id","aws_subnet.subnet_a","aws_subnet.subnet_b.id","aws_subnet.subnet_b"]},"description":"List of both subnet IDs"},"vpc_id":{"expression":{"references":["aws_vpc.main.id","aws_vpc.main"]},"description":"VPC ID"}},"resources":[{"address":"aws_internet_gateway.igw","mode":"managed","type":"aws_internet_gateway","name":"igw","provider_config_key":"aws","expressions":{"tags":{"references":["var.vpc_name","var.environment","var.common_tags"]},"vpc_id":{"references":["aws_vpc.main.id","aws_vpc.main"]}},"schema_version":0},{"address":"aws_route_table.rt","mode":"managed","type":"aws_route_table","name":"rt","provider_config_key":"aws","expressions":{"tags":{"references":["var.vpc_name","var.environment","var.common_tags"]},"vpc_id":{"references":["aws_vpc.main.id","aws_vpc.main"]}},"schema_version":0},{"address":"aws_route_table_association.rta_a","mode":"managed","type":"aws_route_table_association","name":"rta_a","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.rt.id","aws_route_table.rt"]},"subnet_id":{"references":["aws_subnet.subnet_a.id","aws_subnet.subnet_a"]}},"schema_version":0},{"address":"aws_route_table_association.rta_b","mode":"managed","type":"aws_route_table_association","name":"rta_b","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.rt.id","aws_route_table.rt"]},"subnet_id":{"references":["aws_subnet.subnet_b.id","aws_subnet.subnet_b"]}},"schema_version":0},{"address":"aws_security_group.main_sg","mode":"managed","type":"aws_security_group","name":"main_sg","provider_config_key":"aws","expressions":{"description":{"constant_value":"Main security group"},"name":{"references":["var.vpc_name"]},"tags":{"references":["var.vpc_name","var.environment","var.common_tags"]},"vpc_id":{"references":["aws_vpc.main.id","aws_vpc.main"]}},"schema_version":1},{"address":"aws_subnet.subnet_a","mode":"managed","type":"aws_subnet","name":"subnet_a","provider_config_key":"aws","expressions":{"availability_zone":{"references":["var.availability_zone_a"]},"cidr_block":{"references":["var.subnet_cidr_a"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.environment","var.environment","var.common_tags"]},"vpc_id":{"references":["aws_vpc.main.id","aws_vpc.main"]}},"schema_version":1},{"address":"aws_subnet.subnet_b","mode":"managed","type":"aws_subnet","name":"subnet_b","provider_config_key":"aws","expressions":{"availability_zone":{"references":["var.availability_zone_b"]},"cidr_block":{"references":["var.subnet_cidr_b"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.environment","var.environment","var.common_tags"]},"vpc_id":{"references":["aws_vpc.main.id","aws_vpc.main"]}},"schema_version":1},{"address":"aws_vpc.main","mode":"managed","type":"aws_vpc","name":"main","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.vpc_cidr"]},"enable_dns_hostnames":{"constant_value":true},"enable_dns_support":{"constant_value":true},"tags":{"references":["var.vpc_name","var.environment","var.common_tags"]}},"schema_version":1}],"variables":{"availability_zone_a":{"description":"Availability Zone for Subnet A"},"availability_zone_b":{"description":"Availability Zone for Subnet B"},"common_tags":{"description":"Common tags to apply to all resources"},"enable_igw_route":{"default":true,"description":"Whether to add a default route to the Internet Gateway"},"environment":{"description":"Environment tag (e.g. production)"},"region":{"description":"AWS region"},"route_cidr_block":{"description":"CIDR block for route table default route"},"security_group_egress_rules":{"default":[],"description":"List of egress rules"},"security_group_ingress_rules":{"default":[],"description":"List of ingress rules for the security group"},"subnet_cidr_a":{"description":"CIDR block for Subnet A"},"subnet_cidr_b":{"description":"CIDR block for Subnet B"},"trusted_ip_range":{"description":"CIDR block for trusted IP ingress"},"vpc_cidr":{"description":"CIDR block for the VPC"},"vpc_name":{"description":"Name of the VPC"}}}},"rds":{"source":"./modules/rds","expressions":{"allocated_storage":{"references":["var.allocated_storage"]},"common_tags":{"references":["local.common_tags"]},"db_password":{"references":["var.db_password"]},"db_username":{"references":["var.db_username"]},"engine":{"references":["var.engine"]},"engine_version":{"references":["var.engine_version"]},"environment":{"references":["var.environment"]},"instance_class":{"references":["var.instance_class"]},"kms_key_id":{"references":["module.kms.kms_key_id","module.kms"]},"security_group_ids":{"references":["module.networking.security_group_id","module.networking"]},"skip_final_snapshot":{"references":["var.skip_final_snapshot"]},"storage_encrypted":{"references":["var.storage_encrypted"]},"subnet_ids":{"references":["module.networking.subnet_ids","module.networking"]}},"module":{"outputs":{"db_endpoint":{"expression":{"references":["aws_db_instance.postgres.endpoint","aws_db_instance.postgres"]},"description":"RDS instance endpoint"},"db_instance_id":{"expression":{"references":["aws_db_instance.postgres.id","aws_db_instance.postgres"]},"description":"ID of the RDS instance"},"db_subnet_group":{"expression":{"references":["aws_db_subnet_group.db_subnet_group.name","aws_db_subnet_group.db_subnet_group"]},"description":"RDS subnet group name"}},"resources":[{"address":"aws_db_instance.postgres","mode":"managed","type":"aws_db_instance","name":"postgres","provider_config_key":"aws","expressions":{"allocated_storage":{"references":["var.allocated_storage"]},"db_subnet_group_name":{"references":["aws_db_subnet_group.db_subnet_group.name","aws_db_subnet_group.db_subnet_group"]},"engine":{"references":["var.engine"]},"engine_version":{"references":["var.engine_version"]},"identifier":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"instance_class":{"references":["var.instance_class"]},"kms_key_id":{"references":["var.kms_key_id"]},"password":{"references":["var.db_password"]},"skip_final_snapshot":{"references":["var.skip_final_snapshot"]},"storage_encrypted":{"references":["var.storage_encrypted"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.environment","var.common_tags"]},"username":{"references":["var.db_username"]},"vpc_security_group_ids":{"references":["var.security_group_ids"]}},"schema_version":2},{"address":"aws_db_subnet_group.db_subnet_group","mode":"managed","type":"aws_db_subnet_group","name":"db_subnet_group","provider_config_key":"aws","expressions":{"name":{"references":["var.common_tags[\"Name\"]","var.common_tags"]},"subnet_ids":{"references":["var.subnet_ids"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.environment","var.common_tags"]}},"schema_version":0}],"variables":{"allocated_storage":{"default":20,"description":"Amount of allocated storage in GB"},"common_tags":{"description":"Common tags to apply to all resources"},"db_password":{"description":"RDS database password","sensitive":true},"db_username":{"description":"RDS database username"},"engine":{"default":"postgres","description":"Database engine type (e.g., postgres, mysql)"},"engine_version":{"default":"13.4","description":"Version of the database engine"},"environment":{"description":"Deployment environment name"},"instance_class":{"default":"db.t3.micro","description":"The instance class for the RDS instance"},"kms_key_id":{"description":"KMS key ID for RDS encryption"},"security_group_ids":{"description":"Security group IDs to assign to the RDS instance"},"skip_final_snapshot":{"default":true,"description":"Whether to skip final snapshot on DB deletion"},"storage_encrypted":{"default":true,"description":"Whether to enable encryption at rest"},"subnet_ids":{"description":"List of subnet IDs for the DB subnet group"}}}},"route53":{"source":"./modules/route53","expressions":{"domain_name":{"references":["var.cloudfront_domain_aliases[0]","var.cloudfront_domain_aliases"]},"use_existing_zone":{"references":["var.use_existing_route53"]}},"module":{"outputs":{"zone_id":{"expression":{"references":["var.use_existing_zone","data.aws_route53_zone.selected[0].zone_id","data.aws_route53_zone.selected[0]","data.aws_route53_zone.selected","aws_route53_zone.new_zone[0].zone_id","aws_route53_zone.new_zone[0]","aws_route53_zone.new_zone"]}},"zone_name":{"expression":{"references":["var.domain_name"]}}},"resources":[{"address":"aws_route53_zone.new_zone","mode":"managed","type":"aws_route53_zone","name":"new_zone","provider_config_key":"aws","expressions":{"name":{"references":["var.domain_name"]},"tags":{"references":["var.domain_name"]}},"schema_version":0,"count_expression":{"references":["var.use_existing_zone"]}},{"address":"data.aws_route53_zone.selected","mode":"data","type":"aws_route53_zone","name":"selected","provider_config_key":"aws","expressions":{"name":{"references":["var.domain_name"]},"private_zone":{"constant_value":false}},"schema_version":0,"count_expression":{"references":["var.use_existing_zone"]}}],"variables":{"domain_name":{"description":"The domain name to use for the hosted zone"},"use_existing_zone":{"default":true,"description":"Whether to use an existing Route 53 zone or create a new one"}}}},"s3":{"source":"./modules/s3","expressions":{"account_id":{"references":["data.aws_caller_identity.current.account_id","data.aws_caller_identity.current"]},"common_tags":{"references":["local.common_tags"]},"data_bucket_name":{"references":["var.data_bucket_name"]},"kms_key_arn":{"references":["module.kms.kms_key_arn","module.kms"]},"log_bucket_name":{"references":["var.log_bucket_name"]},"s3_acl":{"references":["var.s3_acl"]},"sse_algorithm":{"references":["var.sse_algorithm"]}},"module":{"outputs":{"data_bucket_arn":{"expression":{"references":["aws_s3_bucket.data.arn","aws_s3_bucket.data"]},"description":"ARN of the S3 data bucket"},"data_bucket_id":{"expression":{"references":["aws_s3_bucket.data.id","aws_s3_bucket.data"]},"description":"ID of the S3 data bucket"},"data_bucket_name":{"expression":{"references":["aws_s3_bucket.data.bucket","aws_s3_bucket.data"]},"description":"Name of the data S3 bucket"},"log_bucket_arn":{"expression":{"references":["aws_s3_bucket.logs.arn","aws_s3_bucket.logs"]},"description":"ARN of the S3 log bucket"},"log_bucket_id":{"expression":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"description":"ID of the S3 log bucket"},"log_bucket_name":{"expression":{"references":["aws_s3_bucket.logs.bucket","aws_s3_bucket.logs"]},"description":"Name of the S3 bucket for AWS Config delivery"}},"resources":[{"address":"aws_s3_bucket.data","mode":"managed","type":"aws_s3_bucket","name":"data","provider_config_key":"aws","expressions":{"bucket":{"references":["var.data_bucket_name"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.common_tags"]}},"schema_version":0},{"address":"aws_s3_bucket.logs","mode":"managed","type":"aws_s3_bucket","name":"logs","provider_config_key":"aws","expressions":{"bucket":{"references":["var.log_bucket_name"]},"tags":{"references":["var.common_tags[\"Name\"]","var.common_tags","var.common_tags"]}},"schema_version":0},{"address":"aws_s3_bucket_acl.data_acl","mode":"managed","type":"aws_s3_bucket_acl","name":"data_acl","provider_config_key":"aws","expressions":{"acl":{"references":["var.s3_acl"]},"bucket":{"references":["aws_s3_bucket.data.id","aws_s3_bucket.data"]}},"schema_version":0},{"address":"aws_s3_bucket_acl.logs_acl","mode":"managed","type":"aws_s3_bucket_acl","name":"logs_acl","provider_config_key":"aws","expressions":{"acl":{"references":["var.s3_acl"]},"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]}},"schema_version":0},{"address":"aws_s3_bucket_policy.data_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"data_policy","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.data.id","aws_s3_bucket.data"]},"policy":{"references":["aws_s3_bucket.data.arn","aws_s3_bucket.data","aws_s3_bucket.data.arn","aws_s3_bucket.data","aws_s3_bucket.data.arn","aws_s3_bucket.data"]}},"schema_version":0},{"address":"aws_s3_bucket_policy.logs_policy","mode":"managed","type":"aws_s3_bucket_policy","name":"logs_policy","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"policy":{"references":["aws_s3_bucket.logs.arn","aws_s3_bucket.logs","var.account_id","aws_s3_bucket.logs.arn","aws_s3_bucket.logs","aws_s3_bucket.logs.arn","aws_s3_bucket.logs"]}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.data_block","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"data_block","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.data.id","aws_s3_bucket.data"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_public_access_block.logs_block","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"logs_block","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.data_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"data_encryption","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.data.id","aws_s3_bucket.data"]},"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"references":["var.kms_key_arn"]},"sse_algorithm":{"references":["var.sse_algorithm"]}}]}]},"schema_version":0},{"address":"aws_s3_bucket_server_side_encryption_configuration.logs_encryption","mode":"managed","type":"aws_s3_bucket_server_side_encryption_configuration","name":"logs_encryption","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.logs.id","aws_s3_bucket.logs"]},"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":{"references":["var.kms_key_arn"]},"sse_algorithm":{"references":["var.sse_algorithm"]}}]}]},"schema_version":0}],"variables":{"account_id":{"description":"AWS Account ID for KMS policy"},"common_tags":{"description":"Common tags to apply to all resources"},"data_bucket_name":{"description":"Name of the data S3 bucket"},"kms_key_arn":{"description":"KMS key ARN for bucket encryption"},"log_bucket_name":{"description":"Name of the log S3 bucket"},"s3_acl":{"default":"private","description":"The ACL to apply to the S3 buckets"},"sse_algorithm":{"default":"aws:kms","description":"The server-side encryption algorithm for S3 buckets"}}}},"waf":{"source":"./modules/waf","expressions":{"common_tags":{"references":["local.common_tags"]}},"module":{"outputs":{"cloudfront_waf_web_acl_id":{"expression":{"references":["aws_wafv2_web_acl.cloudfront_acl.id","aws_wafv2_web_acl.cloudfront_acl"]}},"waf_acl_arn":{"expression":{"references":["aws_wafv2_web_acl.cloudfront_acl.arn","aws_wafv2_web_acl.cloudfront_acl"]}}},"resources":[{"address":"aws_wafv2_web_acl.cloudfront_acl","mode":"managed","type":"aws_wafv2_web_acl","name":"cloudfront_acl","provider_config_key":"aws","expressions":{"default_action":[{"allow":[{}]}],"description":{"constant_value":"WAF for CloudFront distribution"},"name":{"constant_value":"cloudfront-waf-acl"},"scope":{"constant_value":"CLOUDFRONT"},"tags":{"references":["var.common_tags"]},"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"cloudfront-waf"},"sampled_requests_enabled":{"constant_value":true}}]},"schema_version":0}],"variables":{"common_tags":{},"managed_rule_groups":{"default":[{"name":"AWSManagedRulesCommonRuleSet","priority":1,"vendor_name":"AWS"}],"description":"List of AWS managed rule groups to attach"}}}}},"variables":{"allocated_storage":{"description":"Amount of allocated storage in GB"},"ami_id":{"description":"AMI ID for EC2 instance"},"availability_zone_a":{"description":"Availability Zone for Subnet A"},"availability_zone_b":{"description":"Availability Zone for Subnet B"},"cloudfront_domain_aliases":{"description":"List of custom domain aliases for CloudFront"},"cost_center":{"description":"Cost center for tracking"},"created_by":{"description":"Who created the infrastructure"},"data_bucket_name":{"description":"Name for the main S3 data bucket"},"db_password":{"description":"Password for RDS database","sensitive":true},"db_username":{"description":"Username for RDS database"},"ebs_device_name":{"description":"The name of the EBS device attached to the EC2 instance"},"engine":{"description":"Database engine type (e.g., postgres, mysql)"},"engine_version":{"description":"Version of the database engine"},"environment":{"description":"Deployment environment (e.g., dev, staging, production)"},"flow_log_group_name":{"description":"The name of the CloudWatch Log Group for flow logs."},"flow_log_role_name":{"description":"IAM Role name for flow logs."},"instance_class":{"description":"The instance class for the RDS instance"},"instance_type":{"description":"EC2 instance type"},"log_bucket_name":{"description":"Name for the S3 log bucket"},"name_prefix":{"description":"Prefix to apply to named resources"},"owner":{"description":"Owner of the infrastructure"},"project":{"description":"Project name"},"region":{"description":"AWS region for deployment"},"retention_in_days":{"description":"Retention period for CloudWatch logs"},"route_cidr_block":{"description":"CIDR block for the default route in the route table"},"s3_acl":{"description":"The ACL to apply to the S3 buckets"},"security_group_egress_rules":{"description":"List of egress rules for the security group"},"security_group_ingress_rules":{"description":"List of ingress rules for the security group"},"skip_final_snapshot":{"description":"Whether to skip final snapshot on DB deletion"},"sse_algorithm":{"description":"The server-side encryption algorithm for S3 buckets"},"storage_encrypted":{"description":"Whether to enable encryption at rest"},"subnet_cidr_a":{"description":"CIDR block for Subnet A"},"subnet_cidr_b":{"description":"CIDR block for Subnet B"},"trusted_ip_range":{"description":"CIDR block for trusted IPs"},"use_existing_route53":{"description":"Flag to determine if an existing hosted zone should be used"},"vpc_cidr":{"description":"CIDR block for the VPC"},"vpc_name":{"description":"Name of the VPC for tagging"}}}},"relevant_attributes":[{"resource":"module.acm.aws_acm_certificate.cloudfront_cert","attribute":["arn"]},{"resource":"module.compute.aws_iam_role.ec2_role","attribute":["id"]},{"resource":"module.config.aws_config_delivery_channel.delivery","attribute":["name"]},{"resource":"module.route53.data.aws_route53_zone.selected[0]","attribute":["zone_id"]},{"resource":"module.logging.aws_iam_role.cmmc_flow_role","attribute":["id"]},{"resource":"module.cloudfront.aws_cloudfront_distribution.secure_distribution","attribute":["arn"]},{"resource":"module.logging.aws_cloudwatch_log_group.cmmc_vpc_flow","attribute":[]},{"resource":"module.networking.aws_subnet.subnet_a","attribute":["id"]},{"resource":"module.cloudfront.aws_cloudfront_origin_access_identity.oai","attribute":["id"]},{"resource":"module.logging.aws_iam_role.cmmc_flow_role","attribute":["name"]},{"resource":"module.cloudfront.aws_cloudfront_distribution.secure_distribution","attribute":["id"]},{"resource":"module.compute.aws_iam_instance_profile.ec2_instance_profile","attribute":["name"]},{"resource":"module.s3.aws_s3_bucket.data","attribute":["arn"]},{"resource":"module.networking.aws_vpc.main","attribute":["id"]},{"resource":"module.compute.aws_iam_role.ec2_role","attribute":["name"]},{"resource":"module.s3.aws_s3_bucket.logs","attribute":["id"]},{"resource":"module.cloudfront.aws_cloudfront_distribution.secure_distribution","attribute":["domain_name"]},{"resource":"module.compute.aws_instance.cmmc_ec2","attribute":["private_ip"]},{"resource":"module.compute.aws_instance.cmmc_ec2","attribute":["id"]},{"resource":"module.acm.aws_route53_record.cert_validation","attribute":[]},{"resource":"module.logging.aws_iam_role.cmmc_flow_role","attribute":["arn"]},{"resource":"module.waf.aws_wafv2_web_acl.cloudfront_acl","attribute":["arn"]},{"resource":"module.cloudfront.aws_cloudfront_origin_access_identity.oai","attribute":["cloudfront_access_identity_path"]},{"resource":"module.compute.aws_instance.cmmc_ec2","attribute":["public_ip"]},{"resource":"module.kms.aws_kms_key.cmmc_kms","attribute":["key_id"]},{"resource":"module.s3.aws_s3_bucket.data","attribute":["bucket"]},{"resource":"module.config.aws_config_configuration_recorder.recorder","attribute":["name"]},{"resource":"module.s3.aws_s3_bucket.logs","attribute":["bucket"]},{"resource":"module.kms.aws_kms_key.cmmc_kms","attribute":["arn"]},{"resource":"module.networking.aws_security_group.main_sg","attribute":["id"]},{"resource":"data.aws_caller_identity.current","attribute":["account_id"]},{"resource":"module.rds.aws_db_instance.postgres","attribute":["endpoint"]},{"resource":"module.config.aws_iam_role.config_role","attribute":["arn"]},{"resource":"module.config.aws_iam_role.config_role","attribute":["id"]},{"resource":"module.networking.aws_internet_gateway.igw","attribute":["id"]},{"resource":"module.s3.aws_s3_bucket.data","attribute":["id"]},{"resource":"module.logging.aws_cloudwatch_log_group.cmmc_vpc_flow","attribute":["name"]},{"resource":"module.networking.aws_route_table.rt","attribute":["id"]},{"resource":"module.networking.aws_subnet.subnet_b","attribute":["id"]},{"resource":"module.logging.aws_flow_log.vpc_flow_log","attribute":["id"]},{"resource":"module.rds.aws_db_instance.postgres","attribute":["id"]},{"resource":"module.logging.aws_cloudwatch_log_group.cmmc_vpc_flow","attribute":["arn"]},{"resource":"module.rds.aws_db_subnet_group.db_subnet_group","attribute":["name"]},{"resource":"module.s3.aws_s3_bucket.logs","attribute":["arn"]},{"resource":"module.cloudtrail.aws_cloudtrail.main","attribute":["arn"]},{"resource":"module.acm.aws_acm_certificate.cloudfront_cert","attribute":["domain_validation_options"]},{"resource":"module.waf.aws_wafv2_web_acl.cloudfront_acl","attribute":["id"]},{"resource":"module.route53.aws_route53_zone.new_zone[0]","attribute":["zone_id"]}],"timestamp":"2025-05-28T06:23:07Z","applyable":true,"complete":true,"errored":false}
